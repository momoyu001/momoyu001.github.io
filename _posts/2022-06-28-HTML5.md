---
layout: post
title: HTML5笔记
---

# HTML5

**如何实现浏览器内多个标签页之间的通信？**

- localStorage

  - localStorage是浏览器多个标签公用的存储空间

  - 针对`非当前页面对localstorage进行修改`时才会触发

  - 原数据的值修改了才会触发

  - ```
    window.addEventListener('storage', function(e) {
    	console.log(e);
    })
    ```

- webWorker

  - 可以提供一个额外的线程来执行一些js代码，并且不会影响到浏览器用户界面。
  - 是浏览器宿主提供的多线程能力。
  - 普通webworker直接使用`new Worker()`创建，这种webworker是当前页面专有的。
  - 共享worker (sharedWorker) 是可以多个标签页，iframe共同使用的。
  - webworker无法在本地使用，在服务上使用，注册一个`onmessage`事件监听信息。客户端发送message就会触发

- webSocket

  - 每个页面都去监听服务器推送的事件，来获得其他页面发送的数据。

- broadcastChannel

  - 是浏览器提供的专门负责数据频道传输的API，它可以让同一个origin下不同标签页、iframe甚至是窗口下的页面之间进行数据的传输。

  - ```
    // 创建一个新的频道
    const channel = new BroadcastChannel('一个标识，用于指定频道');
    
    // 发送数据
    channel.postmessage(data);
    
    // 监听数据
    channel.onmessage = function (e) {};
    channel.onmessageerror = function (error) {};
    
    // 销毁频道
    channel.close();
    ```

  - ```
    typeof window.BroadcastChannel === 'function'
    判断当前浏览器是否支持BroadcastChannel
    ```

------

